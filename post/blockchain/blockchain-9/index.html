<!DOCTYPE html>
<html lang="en-us">
    <head>
         
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Mushroomy&#39;s 9th Blockcahin Story</title>
        
        <link rel="icon" href="https://wacilpong.github.io/favicon.ico">
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: green;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://wacilpong.github.io/css/main.css">


 <link rel="stylesheet" href="https://wacilpong.github.io/css/custom.css"> 


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

    

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.62.0" />
        

        
    </head>

    
    
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <body>
         
        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">Mushroomy&#39;s 9th Blockcahin Story</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/project/">Projects</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="https://github.com/wacilpong/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/areum-han-a10645118/"><i class="fa fa-linkedin"></i></a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>


<main>

    <div class="item">

    
    
    

    
    

    <h4><a href="/post/blockchain/blockchain-9/">Mushroomy&#39;s 9th Blockcahin Story</a></h4>
    <h5>October 25, 2018</h5>
    
    <a href="https://wacilpong.github.iotags/blockchain"><kbd class="item-tag">blockchain</kbd></a>
    

</div>


    <br> <div class="text-justify"><h2 id="truffle-command">Truffle Command</h2>
<ol>
<li>설치 및 버전 확인: 아래의 버전내용이 뜨지 않으면 <code>npm i -g truffle</code>로 설치하자.</li>
</ol>
<!-- raw HTML omitted -->
<p>Truffle v4.1.14 (core: 4.1.14)
Solidity v0.4.24 (solc-js)</p>
<pre><code>
&lt;br&gt;
2. 트러플 프로젝트 초기화 과정
</code></pre><p>test $ truffle init</p>
<p>Downloading&hellip;
Unpacking&hellip;
Setting up&hellip;
Unbox successful. Sweet!</p>
<p>Commands:</p>
<p>Compile:        truffle compile
Migrate:        truffle migrate
Test contracts: truffle test</p>
<p>test $ ls -al</p>
<p>drwxr-xr-x  7 test  staff   224B Oct 25 19:54 .
drwxr-xr-x  4 test  staff   128B Oct 25 19:31 ..
drwxr-xr-x  3 test  staff    96B Oct 25 19:54 build
drwxr-xr-x  4 test  staff   128B Oct 25 19:54 contracts
drwxr-xr-x  4 test  staff   128B Oct 25 19:44 migrations
drwxr-xr-x  2 test  staff    64B Oct 25 19:31 test
-rw-r&ndash;r&ndash;  1 test  staff   545B Oct 25 19:31 truffle-config.js
-rw-r&ndash;r&ndash;  1 test  staff   545B Oct 25 19:31 truffle.js</p>
<pre><code>
&lt;br&gt;
3. 스마트 컨트랙트 생성
</code></pre><p>test $ cd contracts
contracts $ vi MyName.sol</p>
<p>pragma solidity ^0.4.24;</p>
<p>contract MyName {
string myName = &ldquo;JongKwang Coin&rdquo;;</p>
<pre><code>function getMyName() constant public returns(string) {
    return myName;
}

function setMyName(string newMyName) public {
    myName = newMyName;
}
</code></pre>
<p>}
~
~
~
~
:wq</p>
<p>contracts $ ls -al</p>
<p>drwxr-xr-x  4 test  staff  128 Oct 25 19:54 .
drwxr-xr-x  7 test  staff  224 Oct 25 20:05 ..
-rw-r&ndash;r&ndash;  1 test  staff  507 Oct 25 19:31 Migrations.sol
-rw-r&ndash;r&ndash;  1 test  staff  244 Oct 25 19:54 MyName.sol</p>
<pre><code>
&lt;br&gt;
4. 마이그레이션 파일 생성 (for deploying)
</code></pre><p>test $ cd migrations
migrations $ vi 2_deploy_myname.js</p>
<p>var myName = artifacts.require(&quot;./MyName.sol&rdquo;);
module.exports = function(deployer) {
deployer.deploy(myName);
};
~
~
~
~
~
:wq</p>
<p>migrations $ ls -al</p>
<p>drwxr-xr-x  4 test  staff  128 Oct 25 20:09 .
drwxr-xr-x  7 test  staff  224 Oct 25 20:05 ..
-rw-r&ndash;r&ndash;  1 test  staff  129 Oct 25 19:31 1_initial_migration.js
-rw-r&ndash;r&ndash;  1 test  staff  116 Oct 25 19:44 2_deploy_myname.js</p>
<pre><code>
&lt;br&gt;
- 마이그레이션 파일은 반드시 순서대로 만들어져야 한다. `1, 2, 3...`
- 대소문자는 상관없지만 `under bar(_)`로 이루어져야 한다.

&lt;br&gt;
5. 개발환경 구성
</code></pre><p>test $ truffle develop</p>
<p>Truffle Develop started at http://127.0.0.1:9545/</p>
<p>Accounts:
{10개 생성됨}</p>
<p>Private Keys:
{10개 생성됨}</p>
<p>Mnemonic: candy maple cake sugar pudding cream honey rich smooth crumble sweet treat</p>
<p>⚠️  Important ⚠️  : This mnemonic was created for you by Truffle. It is not secure.
Ensure you do not use it on production blockchains, or else you risk losing funds.</p>
<p>truffle(develop)&gt;
truffle(develop)&gt;</p>
<pre><code>
&lt;br&gt;
6. 배포 (한 번만 하면 됨)
</code></pre><p>truffle(develop)&gt; migrate</p>
<p>Compiling ./contracts/Migrations.sol&hellip;
Compiling ./contracts/MyName.sol&hellip;
Writing artifacts to ./build/contracts</p>
<p>Using network &lsquo;develop&rsquo;.</p>
<p>Running migration: 1_initial_migration.js
Deploying Migrations&hellip;
&hellip; {hash}
Migrations: {hash}
Saving successful migration to network&hellip;
&hellip; {hash}
Saving artifacts&hellip;
Running migration: 2_deploy_myname.js
Deploying MyName&hellip;
&hellip; {hash}
MyName: {hash}
Saving successful migration to network&hellip;
&hellip; {hash}
Saving artifacts&hellip;</p>
<pre><code>
&lt;br&gt;
## Truffle (with Web3 API)
</code></pre><p>ttruffle(develop)&gt; web3.eth</p>
<p>Eth {
_requestManager:
RequestManager {
provider:
HttpProvider {
host: &lsquo;http://127.0.0.1:9545/',
timeout: 0,
user: undefined,
password: undefined,
headers: undefined,
send: [Function],
sendAsync: [Function],
_alreadyWrapped: true },
polls: {},
timeout: null },
getBalance:</p>
<p>&hellip; (생략)&hellip;</p>
<pre><code>
&lt;br&gt;

- truffle은 `web3` API를 사용하므로 해당 명령어 사용가능
- command ex)

</code></pre><ol>
<li>MyName.deployed().then(function(instance) { app = nstance; })</li>
<li>web3.fromWei(web3.eth.getBalance(web3.eth.accounts[1]), &ldquo;ether&rdquo;)</li>
<li>app.setMyName(&ldquo;Han&rdquo;, {from: web3.eth.accounts[1]})</li>
<li>app.getMyName()</li>
</ol>
<pre><code>
- MyName 컨트랙트를 `app`이라는 전역변수로 설정
- 두번째 지갑 잔액 보기
- 컨트랙트 내부 함수설정 + 가스비 지불은 2번째 지갑에서
- 컨트랙트 내부 함수호출

&lt;br&gt;
## Ganache
&lt;center&gt;![ganache](/blog/ganache.png)&lt;/center&gt;

&lt;br&gt;
- 사진에서 보여주듯, `RPC(Remote Procedure Call)`서버로 연결되어 있다.
- RPC는 별도의 원격제어를 위해 다른 주소에서 함수나 프로시저를 실행할 수 있게 해주는 프로세스 간 통신기술이다.
- 가나슈는 `127.0.0.1:7545`로 연결되어 있다.
- 127.0.0.1은 IPv4에서 본인의 컴퓨터를 의미하는 `루프백(loop back)` 호스트명이다.
- 이때 루프백이란 라우팅, 스트림 등의 흐름이 별도 가공없이 원래의 장치로 돌아간다는 의미이다.

&lt;br&gt;
1. truffle-config.js: ganache에 트러플 연결
</code></pre><p>module.exports = {
networks: {
development: {
host: &ldquo;127.0.0.1&rdquo;,
port: 8545,
network_id: &ldquo;*&rdquo; // Match any network id
}
}
};</p>
<pre><code>
&lt;br&gt;
2. command
</code></pre><p>truffle  console  &ndash;network development
migrate  &ndash;compile-all  —reset</p>
<pre><code>
&lt;br&gt;
=&gt; 1개 블록에 1개의 트랜잭션만 담는다.

&lt;br&gt;

***Truffle pet shop***

- [Ref: truffle pet shop](https://truffleframework.com/tutorials/pet-shop)
- [참고: 트러플 펫샵 튜토리얼](https://steemit.com/etherum/%40dongshik/ethereum-pet-shop-and-truffle)</code></pre></div>

    
    

    

        <h4 class="page-header">Related</h4>

         <div class="item">

    
    
    

    
    

    <h4><a href="/post/blockchain/blockchain-10/">Mushroomy&#39;s Last Blockcahin Story</a></h4>
    <h5>October 26, 2018</h5>
    
    <a href="https://wacilpong.github.iotags/blockchain"><kbd class="item-tag">blockchain</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/blockchain/blockchain-8/">Mushroomy&#39;s 8th Blockcahin Story</a></h4>
    <h5>October 24, 2018</h5>
    
    <a href="https://wacilpong.github.iotags/blockchain"><kbd class="item-tag">blockchain</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/blockchain/blockchain-7/">Mushroomy&#39;s 7th Blockcahin Story</a></h4>
    <h5>October 23, 2018</h5>
    
    <a href="https://wacilpong.github.iotags/blockchain"><kbd class="item-tag">blockchain</kbd></a>
    

</div>
 

    

    

</main>

        <footer>

            <p class="copyright text-muted">© All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a></p>

        </footer>
       
    </body>

</html>

