<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Publish to aws s3 with s3cmd</title>
        
            <link rel="icon" href="https://wacilpong.github.io/blog/favicon.ico">
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #469160;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://wacilpong.github.io/blog/css/main.css">


 <link rel="stylesheet" href="https://wacilpong.github.io/blog/css/custom.css"> 


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.58.3" />
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Publish to aws s3 with s3cmd</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/blog/">Home</a></li>
                            
                                <li><a href="/blog/post/">Posts</a></li>
                            
                                <li><a href="/blog/project/">Projects</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="https://github.com/wacilpong/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/areum-han-a10645118/"><i class="fa fa-linkedin"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>Publish to aws s3 with s3cmd</h2>
        <h5>February 9, 2018</h5>
        
<a href="https://wacilpong.github.io/blog/tags/aws"><kbd class="item-tag">aws</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/deploy"><kbd class="item-tag">deploy</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/environment"><kbd class="item-tag">environment</kbd></a>


    </div>

    <div align="start" class="content">

<h3 id="1-create-s3-bucket">1. Create S3 bucket</h3>

<p>Create S3 bucket with public access in aws S3 console, because it is just for testing. And add static website hosting property with <code>index.html</code> (entry point).</p>

<p><br /></p>

<h3 id="2-create-cloudfront-distributions">2. Create CloudFront Distributions</h3>

<p>Create in aws CloudFront console. And Just keep all settings.</p>

<p><br /></p>

<h3 id="3-connect-domain-with-cloudfront">3. Connect domain with CloudFront</h3>

<p>If you don&rsquo;t have routing domain in aws Route 53 console, create it first like <code>test.example.com</code>. It just depends on your url rules. Then connect with IPv4 with the CloudFront that you created.</p>

<p><br /></p>

<h3 id="4-install-s3cmd">4. Install s3cmd</h3>

<p>s3cmd is a command line for s3 client or backup in linux and mac. s3express is for windows user, check it. I installed it using homebrew.</p>

<pre><code class="language-s">brew install s3cmd
</code></pre>

<p>Type <code>s3cmd</code> on command line, then command list (help) will be appear.</p>

<p><br /></p>

<h3 id="5-configure-s3cmd-s3cfg">5. Configure s3cmd (.s3cfg)</h3>

<p>We need to set aws access key to s3cmd to access s3 bucket.</p>

<pre><code class="language-s">s3cmd --configure
</code></pre>

<p>Many properties can be set. but now we just need to type aws access key and secret key that can be generated in aws. Then check s3 buckets that connected with your key.</p>

<pre><code class="language-s">s3cmd ls
</code></pre>

<p><br /></p>

<h3 id="6-publish-to-s3-from-local">6. Publish to S3 from local</h3>

<p>First of all, we need to build our source code. I am dealing with angular5 project, so I am using <code>ng</code> command.</p>

<pre><code class="language-s">ng build : --env prod --aot
s3cmd { put, sync } --cf-invalidate -P -r project-path/dist/* s3://test.example.com
</code></pre>

<p><br /></p>

<p>If you publish for the first time, use <code>put</code> command. It will publish all files and directories. And <code>sync</code> command will publish the files and directories that only be changed. And <code>:</code> means builds all our files. <code>--aot</code>(&lt;-&gt; <code>jit</code>) option means ahead-of-time;build files during the build phase before the browser downloads and runs that code. <code>--cf</code> means remove all chached files in CloudFront.</p>
</div>

    
    
    
        <h4 class="page-header">Related</h4>
         <div class="item">

    
    
    

    
    

    <h4><a href="/blog/post/environment/babel-polyfill-and-babel-runtime/">Babel polyfill and babel runtime</a></h4>
    <h5>January 17, 2020</h5>
    
<a href="https://wacilpong.github.io/blog/tags/babel"><kbd class="item-tag">babel</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/environment"><kbd class="item-tag">environment</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/blog/post/environment/prerender-status-code/">Prerender Status Code</a></h4>
    <h5>October 6, 2019</h5>
    
<a href="https://wacilpong.github.io/blog/tags/seo"><kbd class="item-tag">SEO</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/prerender"><kbd class="item-tag">prerender</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/environment"><kbd class="item-tag">environment</kbd></a>



</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/blog/post/environment/react-file-structure/">File structure with React</a></h4>
    <h5>July 10, 2019</h5>
    
<a href="https://wacilpong.github.io/blog/tags/react"><kbd class="item-tag">react</kbd></a>

<a href="https://wacilpong.github.io/blog/tags/environment"><kbd class="item-tag">environment</kbd></a>



</div>
 
    

    
    
        <h4 class="page-header">Comments</h4>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "roomy-han" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

</main>

        <footer>
            <p class="copyright text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p>
        </footer>

        

        
    </body>

</html>

